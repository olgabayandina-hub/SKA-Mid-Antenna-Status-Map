<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    #plot {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
<div id="plot"></div>

<script>
// CSV data (your same dataset)
const csvData = `Name,E,N
M000,112.76579059948781,-79.170785650142
M001,122.15079102183142,-43.64243263150298
M002,88.91673979104473,-96.1158423002747
M003,54.51220105543081,-74.15572577944681
M004,-2.594457625275968,-124.82495134230146
M005,18.941432165623134,-155.00009509467256
M006,102.79734508647452,-167.30845109616666
M007,31.4360868783177,-274.6114892693569
M008,27.499147245566277,-406.9049848140227
M009,153.38404566212407,-242.93559447793658
M010,209.12084975474107,-383.7538403116619
M011,205.04043182784415,-223.95876557042732
M012,261.0471707984131,-240.14913382773835
M013,357.81887465632775,-265.34271260710284
M014,401.6983761442501,-157.6764795441323
M015,331.67390581005816,-91.02463228102303
M016,409.18881130278396,-57.757190252825325
M017,320.6539294078751,15.853787092565153
M018,226.75604843349038,-117.75191213346531
M019,291.8152217901651,-157.106425160777
M020,218.04467747420045,-171.520327500559
M021,-174.93749207272018,-199.1182085285144
M022,-251.9695799975054,128.6672633302968
M023,-201.27559209344727,-14.061538225363822
M024,-230.01226687302804,278.2106118151796
M025,-60.94307866297918,353.7382639018657
M026,22.028935110946865,145.16623273558793
M027,161.50678174949292,105.0066409318826
M028,69.8521456437838,40.95029815098774
M029,32.26971051710125,4.009222167467673
M030,292.3142771764855,242.0661927161583
M031,367.59942119713986,221.87292984261904
M032,582.3083701745802,303.6188852917529
M033,701.7195898894714,992.0711558743253
M034,478.8418669773874,99.80682412811883
M035,507.1827233267039,-52.777708347560576
M036,509.28466221867546,-162.64415936400331
M037,501.31160227805253,-331.193402050995
M038,334.33387460083657,-440.9630584550911
M039,374.77354341646384,-464.0300098913982
M040,94.16649472215579,-584.0991788881855
M041,-166.5209108049608,-533.5554012811699
M042,-240.68638705948302,-332.19443205706125
M043,-508.821392883417,-0.19920407181207644
M044,-775.1255794616411,728.6259952051525
M045,-1711.8240154085697,394.8896526104749
M046,-1346.2892386562737,1880.0583372592503
M047,-457.26884192190437,-389.1701821572756
M048,-2684.5903102778493,2815.0125055386193
M049,-3484.919240186625,564.6218464976283
M050,-1931.313633591142,-715.572400387941
M051,-729.2308606601948,-641.2301382455114
M052,-472.1720963264991,-1020.5255794137561
M053,130.3815903312862,-1176.3426747672033
M054,993.0061033965097,-371.7028683252962
M055,1322.812222771544,224.59758940242529
M056,1719.439619911292,594.7680624930589
M057,415.71354990642874,3388.029607758819
M058,2926.825396633756,2814.959914257432
M059,3807.4668440944642,886.9725332630735
M060,3540.6937125360737,-1712.3966609076253
M061,104.598440042589,-2195.6592154374393
M062,-1319.626669975541,-2375.6361711096574
M063,-3298.5728541699273,-1712.322696281461
SKA001,650.1728394276952,-119.66238077606873
SKA002,56.372962871704324,73.95917571931608
SKA003,-27.170732995314225,138.05020232363665
SKA004,74980.09336231455,47564.910897493915
SKA005,-52861.413835926694,49761.68271581534
SKA006,-31788.878406674285,50018.47516915039
SKA007,-15357.988154045906,45353.390276249855
SKA008,-81405.72430397318,44452.079298733646
SKA009,-1951.1295857873392,38846.201710469
SKA010,3704.6501151649045,30475.558812618165
SKA011,69093.62662908217,23134.591700316007
SKA012,9057.13267127596,24054.24543240285
SKA013,12858.845223453884,16775.36900671986
SKA014,12041.614356675735,9960.933639750156
SKA015,-6559.1973782280675,8161.935580060105
SKA016,-11196.266775695223,7587.801968229518
SKA017,-3479.6832378058307,7677.818451350274
SKA018,-1604.0935895045795,6469.779037686144
SKA019,-15890.493162927964,5897.104951163366
SKA020,876.3004149835588,5865.058812338631
SKA021,57907.12253388949,5745.443010565202
SKA022,12577.783425820931,4717.225953100699
SKA023,1750.0539374683403,4184.859913903716
SKA024,1867.01314606932,2833.3042351614445
SKA025,-20291.847165505977,2815.138288019265
SKA026,2050.8353504316115,2202.175539883292
SKA027,10397.43531961863,1906.3666473354162
SKA028,-1192.505785996591,1269.6584053458462
SKA029,-779.3659471519977,1213.812289893888
SKA030,-342.69487284658635,1092.7500039754314
SKA031,-2018.4821904373325,1067.6178922201864
SKA032,2104.2231506542034,1042.764806097442
SKA033,176.68930160509177,801.5752381158255
SKA034,-2783.6123488334442,671.8152688875434
SKA035,-156.76796458157088,631.3693703077155
SKA036,256.30283686329744,486.997542377143
SKA037,1878.1866349033728,384.26975665393104
SKA038,-194.9726015530784,365.69233694034557
SKA039,101.63406583612016,327.8817589806993
SKA040,-723.0129103402272,356.82656857201573
SKA041,-94.55321601958856,168.76447446550856
SKA042,239.00082108082654,115.64917406481158
SKA043,-338.69768746988143,103.44931055921742
SKA044,109.0575165397491,103.12125170854128
SKA045,924.9187285224571,53.406003078574486
SKA046,166.09003631338572,42.79990835956467
SKA047,-199.57538478941552,32.487563446237445
SKA048,-25.849047268690963,20.624174011883518
SKA049,90.90127219877932,11.531175814859859
SKA050,173.5911234606108,1.9942571814124843
SKA051,123.70475019318168,0.44272172807885035
SKA052,0.0,0.0
SKA053,66.82422365153356,-11.753421918962157
SKA054,451.1407144689998,-21.631842573753236
SKA055,-92.65421702639817,-21.954898973456764
SKA056,99.81982519965993,-24.062680673957576
SKA057,32.909221548236175,-26.501417019527146
SKA058,-35.85063705845088,-30.38179620077085
SKA059,153.4996875379868,-36.92502757529421
SKA060,-3581.753715040174,-37.854024681179894
SKA061,291.86269998286383,-37.81553009715009
SKA062,62.65664864770494,-42.80100009201438
SKA063,-707.258267601065,-48.47867876525534
SKA064,-2.0315930098257926,-55.885593830119745
SKA065,30.035169363070445,-56.66162146630863
SKA066,180.60251799457012,-70.85617406033248
SKA067,238.69952838294583,-80.94718200653368
SKA068,-68.2520185424908,-81.94296466211674
SKA069,5.805103881203991,-85.37994285188857
SKA070,1510.6380695808027,-86.62334716104917
SKA071,141.82085779486542,-86.49040175511463
SKA072,-27.544628276447096,-97.35590388142921
SKA073,57.1479726120923,-106.78112681741652
SKA074,27.916854306580987,-118.6454315198186
SKA075,125.5238527256948,-123.85778232145128
SKA076,159.29494126289316,-127.84985293018603
SKA077,-247.88658562214098,-132.3975323714378
SKA078,-34.75793200686033,-133.2818805037756
SKA079,92.9016067019714,-135.61071782712423
SKA080,60.28026552135618,-140.82166082584675
SKA081,190.34452861991272,-154.3515998961723
SKA082,136.45465783114187,-161.22589221347914
SKA083,-466.42576630372747,-167.0002566096602
SKA084,-71.63346907361283,-174.64166206708447
SKA085,-13.892423499431771,-177.19217442205897
SKA086,74.53569835657925,-182.62599689363438
SKA087,11.362224378215348,-200.92115944239077
SKA088,101.3316045882746,-216.00176729669562
SKA089,303.66158893782347,-216.22744643871317
SKA090,-150.9680658869217,-274.21659641818155
SKA091,88.72381367074813,-284.63893490015244
SKA092,465.4043058021823,-295.84726054049895
SKA093,-44.491760248612664,-296.72537012487913
SKA094,155.78603862669215,-322.8938716792047
SKA095,-261.3883432019926,-384.769918383749
SKA096,1237.0739417972518,-391.7123963389412
SKA097,125.8170863659809,-423.1331551576584
SKA098,-477.450579017548,-439.44292957628477
SKA099,226.696962499324,-461.9442508259433
SKA100,614.1639694256489,-555.7667367989175
SKA101,195.08714888873746,-681.6045517575035
SKA102,-600.6458265536497,-723.8651351871356
SKA103,-230.7808130093523,-782.1762672633781
SKA104,444.5328502865168,-889.5194000618837
SKA105,8590.270695377809,-1283.4116897937506
SKA106,-936.5346296162649,-964.8966064028457
SKA107,-4322.894075771649,-1133.5481061936453
SKA108,-835.9386190189706,-1437.9380855822644
SKA109,-477.03055669595005,-1918.7463378963168
SKA110,6561.108993614926,-2505.71357309442
SKA111,-19.96177046040657,-2443.884882737975
SKA112,-24795.908385694158,-1869.3111910407476
SKA113,-4876.996293308105,-2675.853009872226
SKA114,939.244496405001,-3054.719307996532
SKA115,4904.765423207394,-2742.293391860622
SKA116,1690.1436421777623,-3305.043244082667
SKA117,2894.7846671556117,-2717.4985468164323
SKA118,-4592.012921141998,-4445.445045519697
SKA119,-4352.880846516791,-7357.042033617718
SKA120,42593.22268563016,-5362.459956950972
SKA121,-2862.52593221951,-9954.492610429466
SKA122,-28503.037861032928,-10863.610813181303
SKA123,-1811.673956478306,-14345.986666663572
SKA124,34622.062149982296,-14723.830293444837
SKA125,1562.3228914479812,-16974.633934304493
SKA126,6345.658563063476,-18571.00073962824
SKA127,24360.284624906148,-19041.011188185053
SKA128,18459.922994129614,-17421.558734766382
SKA129,-31907.289829143134,-22047.431526271856
SKA130,-34892.53354099483,-36614.82771080987
SKA131,-26032.441825535403,-54260.82808396529
SKA132,-16667.852054968065,-69404.87055470856
SKA133,5356.907279534955,-89531.11817482181`;

// Parse CSV
const rows = csvData.trim().split("\n").slice(1).map(line => {
  const [Name, E, N] = line.split(",");
  return { Name, E: parseFloat(E), N: parseFloat(N) };
});

// Define antenna categories
const paleGreen = ["SKA004","SKA009","SKA010","SKA012","SKA042","SKA047","SKA054","SKA073", "SKA074","SKA076","SKA078","SKA080","SKA085","SKA086","SKA087","SKA088","SKA090","SKA094","SKA098","SKA102","SKA103","SKA104","SKA106","SKA109","SKA113","SKA120","SKA123","SKA124","SKA125","SKA126","SKA127","SKA128","SKA132"];
const darkerGreen = ["SKA002","SKA003","SKA005","SKA006","SKA008","SKA013","SKA014","SKA016","SKA019","SKA022","SKA025","SKA027","SKA028","SKA029","SKA030","SKA032","SKA033","SKA035","SKA037","SKA038","SKA039","SKA040","SKA041","SKA043","SKA044","SKA045","SKA049","SKA050","SKA051","SKA052","SKA053","SKA055","SKA056","SKA057","SKA058","SKA059","SKA061","SKA062","SKA064","SKA065","SKA066","SKA067","SKA068","SKA069","SKA070","SKA071","SKA072","SKA075","SKA079","SKA082","SKA083","SKA084","SKA089","SKA091","SKA092","SKA093","SKA095","SKA096","SKA097","SKA099","SKA108","SKA112"];
const darkGreen = ["SKA046","SKA048","SKA077","SKA081"];

// Assign colours
rows.forEach(row => {
  if (row.Name.startsWith("M")) {
    row.color = "#E0E0E0"; // MeerKAT
  } else if (paleGreen.includes(row.Name)) {
    row.color = "#A8E6A3";
  } else if (darkerGreen.includes(row.Name)) {
    row.color = "#4CAF50";
  } else if (darkGreen.includes(row.Name)) {
    row.color = "#006400";
  } else {
    row.color = "#B0B0B0"; // Other SKA antennas
  }
});

// Build scatter plot trace
const trace = {
  x: rows.map(p => p.E),
  y: rows.map(p => p.N),
  mode: 'markers',
  type: 'scatter',
  marker: {
    size: 8,
    color: rows.map(p => p.color),
    line: { width: 0 }
  },
  text: rows.map(p => p.Name),
  hovertemplate: "%{text}<extra></extra>"
};

// Axes settings
const kmRange = 100; // visible range in km
const tickStep = 20 * 1000; // 20 km
const tickVals = [];
const tickTexts = [];

for(let v = -kmRange*1000; v <= kmRange*1000; v += tickStep) {
  tickVals.push(v);
  tickTexts.push((v / 1000).toString());
}

// Layout
const layout = {
  title: "SKA Antenna Status Map",
  xaxis: {
    title: "Easting (km)",
    scaleanchor: "y",
    scaleratio: 1,
    range: [-100000, 100000],
    tickvals: tickVals,
    ticktext: tickTexts,
    showgrid: false,
    zeroline: false
  },
  yaxis: {
    title: "Northing (km)",
    range: [-100000, 100000],
    tickvals: tickVals,
    ticktext: tickTexts,
    showgrid: false,
    zeroline: false
  },
  showlegend: false,
  margin: { t: 40, l: 50, r: 50, b: 50 }
};

// Separate SKA and MeerKAT antennas
const skaPoints = rows.filter(r => !r.Name.startsWith("M"));
const meerkatPoints = rows.filter(r => r.Name.startsWith("M"));

// MeerKAT dishes — circles (drawn first so they appear in background)
const meerkatTrace = {
  x: meerkatPoints.map(p => p.E),
  y: meerkatPoints.map(p => p.N),
  mode: 'markers',
  type: 'scatter',
  marker: {
    size: 8,
    color: meerkatPoints.map(p => p.color),
    symbol: 'circle',
    line: { width: 0 }
  },
  text: meerkatPoints.map(p => p.Name),
  hovertemplate: "%{text}<extra></extra>",
  name: "MeerKAT"
};

// SKA antennas — hexagons (drawn second so they overlay)
const skaTrace = {
  x: skaPoints.map(p => p.E),
  y: skaPoints.map(p => p.N),
  mode: 'markers',
  type: 'scatter',
  marker: {
    size: 11,  // slightly larger than circles
    color: skaPoints.map(p => p.color),
    symbol: 'hexagon',
    line: { width: 0.5, color: '#222' } // subtle outline to make them pop
  },
  text: skaPoints.map(p => p.Name),
  hovertemplate: "%{text}<extra></extra>",
  name: "SKA"
};

// Draw SKA *after* MeerKAT so it stays on top
Plotly.newPlot('plot', [meerkatTrace, skaTrace], layout);

// Add telescope SVG icons for selected antennas
const telescopeNames = ["SKA001", "SKA063", "SKA100"];
const telescopePoints = skaPoints.filter(p => telescopeNames.includes(p.Name));

const icons = telescopePoints.map(p => ({
  source: "SKA-Mid Icon.svg",
  xref: "x",
  yref: "y",
  x: p.E,
  y: p.N,
  sizex: 100,   // adjust these to set icon size in coordinate units
  sizey: 100,
  xanchor: "center",
  yanchor: "middle",
  layer: "above"
}));

Plotly.relayout('plot', { images: icons });

</script>
</body>
</html>
